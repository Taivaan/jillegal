<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Jillegal by serkan-ozal</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Jillegal</h1>
        <p>Java Off Heap Object Pool and On the Fly Instrumentation Tool</p>
        <p class="view"><a href="https://github.com/serkan-ozal/jillegal">View the Project on GitHub <small>serkan-ozal/jillegal</small></a></p>
        <ul>
          <li><a href="https://github.com/serkan-ozal/jillegal/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/serkan-ozal/jillegal/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/serkan-ozal/jillegal">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="1-what-is-jillegal" class="anchor" href="#1-what-is-jillegal"><span class="octicon octicon-link"></span></a>1. What is Jillegal?</h1>

<p><strong>Jillegal</strong> is a library including unknown tricks of Java. It abstracts developer from low-level details to implement those tricks. Its design and logic are based on <strong>Java 8</strong> and <strong>JRockit</strong> so it can be used at only <strong><em>Java 8 and JRockit platforms</em></strong>. Java 6 and Java 7 supports are in progress and as soon as possible they will be released. Demo application is avaiable at <a href="https://github.com/serkan-ozal/jillegal-demo">https://github.com/serkan-ozal/jillegal-demo</a>. </p>

<p>Currently it has three main modules: <strong>OffHeap</strong>, <strong>Instrumentation</strong> and <strong>In Memory Compiler</strong>. </p>

<h2>
<a name="11-offheap-module" class="anchor" href="#11-offheap-module"><span class="octicon octicon-link"></span></a>1.1. OffHeap Module</h2>

<p>Design and logic of Jillegal OffHeap module different from all of the other offheap frameworks. It doesn't serilalize/deserialize objects to/from allocated offheap memory region. Because objects already lives on offheap and GC doesn't track them :). With this feature, all objects in pool are exist as sequential at memory, so sequential accessing to them is faster. Because, they will be fetched to CPU cache together as limited size of CPU cache.</p>

<h2>
<a name="12-instrumentation-module" class="anchor" href="#12-instrumentation-module"><span class="octicon octicon-link"></span></a>1.2. Instrumentation Module</h2>

<p>Instrumenting and redefining any Java class, interface, ... (even core Java classes) at runtime with developer friendly API (with Builder Pattern based design) is supported. You can add your custom pre/post listeners to method and constructor invocations dynamically. It serves a platform to develop your custom AOP framework. It uses Java Instrumentation API but adding extra VM argument (like <code>-javaagent:&lt;jarpath&gt;[=&lt;options&gt;]</code> is not required. <strong>Jillegal</strong> has its own internal agent and it can enable it's agent at runtime dynamically.</p>

<h2>
<a name="13-in-memory-compiler-module" class="anchor" href="#13-in-memory-compiler-module"><span class="octicon octicon-link"></span></a>1.3. In Memory Compiler Module</h2>

<p>Compiling Java and Groovy source codes in memory is supported. You can compile your Java and Groovy based source codes at runtime in memory and can get its compiled class.</p>

<h1>
<a name="2-compile-and-build" class="anchor" href="#2-compile-and-build"><span class="octicon octicon-link"></span></a>2. Compile and Build</h1>

<ol>
<li><p>First clone code from GitHub.
<code>git clone https://github.com/serkan-ozal/jillegal.git</code></p></li>
<li>
<p>To set <strong>JDK / JRE</strong>  installation/home directory:</p>

<p>2.1. Add an environment variable named <code>JAVA8_HOME</code> points to <strong>JDK 8 / JRE 8</strong>  installation/home directory.</p>

<p>2.2. Add an environment variable named <code>JROCKIT_HOME</code> points to <strong>JRockit JDK / JRockit JRE</strong>  installation/home directory.</p>
</li>
<li><p>Compile with maven.
<code>mvn clean install</code></p></li>
</ol><h1>
<a name="3-installation" class="anchor" href="#3-installation"><span class="octicon octicon-link"></span></a>3. Installation</h1>

<p>In your <code>pom.xml</code>, you must add repository and dependency for <strong>Jillegal</strong>. 
You can change <code>jillegal.version</code> to any existing <strong>Jillegal</strong> library version.
Latest version is <code>2.1-SNAPSHOT</code>.</p>

<div class="highlight highlight-xml"><pre>...
<span class="nt">&lt;properties&gt;</span>
    ...
    <span class="nt">&lt;jillegal.version&gt;</span>2.1-SNAPSHOT<span class="nt">&lt;/jillegal.version&gt;</span>
    ...
<span class="nt">&lt;/properties&gt;</span>
...
<span class="nt">&lt;dependencies&gt;</span>
    ...
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>tr.com.serkanozal<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>jillegal<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>${jillegal.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    ...
<span class="nt">&lt;/dependencies&gt;</span>
...
<span class="nt">&lt;repositories&gt;</span>
    ...
    <span class="nt">&lt;repository&gt;</span>
        <span class="nt">&lt;id&gt;</span>serkanozal-maven-repository<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;url&gt;</span>https://github.com/serkan-ozal/maven-repository/raw/master/<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/repository&gt;</span>
    ...
<span class="nt">&lt;/repositories&gt;</span>
...
</pre></div>

<p>For <strong>JRockit</strong> usage, change <strong><code>artifactId</code></strong> to <strong><code>jillegal-jrockit</code></strong> in dependency such as:</p>

<div class="highlight highlight-xml"><pre>...
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>tr.com.serkanozal<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>jillegal-jrockit<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>${jillegal.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
...
</pre></div>

<h1>
<a name="4-usage" class="anchor" href="#4-usage"><span class="octicon octicon-link"></span></a>4. Usage</h1>

<p>To initialize Jillegal and find Jillegal Aware classes, there are two ways:</p>

<p>1) You just need to call explicitly making aware method at startup in anywhere of your application.</p>

<div class="highlight highlight-java"><pre><span class="o">...</span>

<span class="n">tr</span><span class="o">.</span><span class="na">com</span><span class="o">.</span><span class="na">serkanozal</span><span class="o">.</span><span class="na">jillegal</span><span class="o">.</span><span class="na">Jillegal</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>

<span class="o">...</span>
</pre></div>

<p>or</p>

<p>2) You can extend your main class from <strong><code>tr.com.serkanozal.jillegal.util.JillegalAware</code></strong> class.</p>

<div class="highlight highlight-java"><pre><span class="o">...</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JillegalDemo</span> <span class="kd">extends</span> <span class="n">JillegalAware</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="o">...</span>

    <span class="o">}</span>

<span class="o">}</span>   

<span class="o">...</span>
</pre></div>

<h2>
<a name="41-jillegal-aware-offheap-pool" class="anchor" href="#41-jillegal-aware-offheap-pool"><span class="octicon octicon-link"></span></a>4.1. Jillegal Aware OffHeap Pool</h2>

<p>To make any of your class, just annotate it with <strong><code>tr.com.serkanozal.jillegal.config.annotation.JillegalAware</code></strong> annotation. So it will be detected by Jillegal on initialize cycle and will be instrumented automatically to be aware of Jillegal.</p>

<div class="highlight highlight-java"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleClassWrapper</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">SampleClass</span> <span class="n">sampleClass</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">SampleClass</span> <span class="nf">getSampleClass</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">sampleClass</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSampleClass</span><span class="o">(</span><span class="n">SampleClass</span> <span class="n">sampleClass</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">sampleClass</span> <span class="o">=</span> <span class="n">sampleClass</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>

<div class="highlight highlight-java"><pre><span class="nd">@JillegalAware</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JillegalAwareSampleClassWrapper</span> <span class="o">{</span>

    <span class="nd">@OffHeapObject</span>
    <span class="kd">private</span> <span class="n">SampleClass</span> <span class="n">sampleClass</span><span class="o">;</span>

    <span class="nd">@OffHeapArray</span><span class="o">(</span><span class="n">length</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">SampleClass</span><span class="o">[]</span> <span class="n">sampleClassArray</span><span class="o">;</span>

    <span class="kd">public</span> <span class="n">SampleClass</span> <span class="nf">getSampleClass</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">sampleClass</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSampleClass</span><span class="o">(</span><span class="n">SampleClass</span> <span class="n">sampleClass</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">sampleClass</span> <span class="o">=</span> <span class="n">sampleClass</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">SampleClass</span><span class="o">[]</span> <span class="nf">getSampleClassArray</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">sampleClassArray</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSampleClassArray</span><span class="o">(</span><span class="n">SampleClass</span><span class="o">[]</span> <span class="n">sampleClassArray</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">sampleClassArray</span> <span class="o">=</span> <span class="n">sampleClassArray</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>

<div class="highlight highlight-java"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleClass</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="n">i1</span> <span class="o">=</span> <span class="mi">5</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">i2</span> <span class="o">=</span> <span class="mi">10</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">order</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">SampleLinkClass</span> <span class="n">link</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getI1</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">i1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getI2</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">i2</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getOrder</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">order</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setOrder</span><span class="o">(</span><span class="kt">int</span> <span class="n">order</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">order</span> <span class="o">=</span> <span class="n">order</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">SampleLinkClass</span> <span class="nf">getLink</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">link</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLink</span><span class="o">(</span><span class="n">SampleLinkClass</span> <span class="n">link</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">link</span> <span class="o">=</span> <span class="n">link</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>

<div class="highlight highlight-java"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleLinkClass</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kt">long</span> <span class="n">linkNo</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getLinkNo</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">linkNo</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setLinkNo</span><span class="o">(</span><span class="kt">long</span> <span class="n">linkNo</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">linkNo</span> <span class="o">=</span> <span class="n">linkNo</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>

<div class="highlight highlight-java"><pre>
<span class="n">JillegalAwareSampleClassWrapper</span> <span class="n">sampleClassWrapper</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">JillegalAwareSampleClassWrapper</span><span class="o">();</span>

<span class="n">sampleClassWrapper</span><span class="o">.</span><span class="na">getSampleClass</span><span class="o">().</span><span class="na">setOrder</span><span class="o">(-</span><span class="mi">1</span><span class="o">);</span>

<span class="n">SampleClass</span><span class="o">[]</span> <span class="n">objArray</span> <span class="o">=</span> <span class="n">sampleClassWrapper</span><span class="o">.</span><span class="na">getSampleClassArray</span><span class="o">();</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">objArray</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">SampleClass</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">objArray</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="n">obj</span><span class="o">.</span><span class="na">setOrder</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Order value of auto injected off-heap object field has been set to "</span> <span class="o">+</span> <span class="n">i</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Order value of sample object at off heap pool: "</span> <span class="o">+</span> 
<span class="n">sampleClassWrapper</span><span class="o">.</span><span class="na">getSampleClass</span><span class="o">().</span><span class="na">getOrder</span><span class="o">());</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">objArray</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">SampleClass</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">objArray</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Order value of "</span> <span class="o">+</span> <span class="n">i</span> <span class="o">+</span> <span class="s">". object at off heap pool: "</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="na">getOrder</span><span class="o">());</span>
<span class="o">}</span>

</pre></div>

<h2>
<a name="42-eager-referenced-object-offheap-pool" class="anchor" href="#42-eager-referenced-object-offheap-pool"><span class="octicon octicon-link"></span></a>4.2. Eager Referenced Object OffHeap Pool</h2>

<div class="highlight highlight-java"><pre>
<span class="n">OffHeapService</span> <span class="n">offHeapService</span> <span class="o">=</span> <span class="n">OffHeapServiceFactory</span><span class="o">.</span><span class="na">getOffHeapService</span><span class="o">();</span>

<span class="n">ObjectOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">offHeapPoolParameterBuilder</span> <span class="o">=</span> 
                <span class="k">new</span> <span class="n">ObjectOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;().</span>
                        <span class="n">type</span><span class="o">(</span><span class="n">SampleClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span>
                        <span class="n">objectCount</span><span class="o">(</span><span class="n">ELEMENT_COUNT</span><span class="o">).</span>
                        <span class="n">makeOffHeapableAsAuto</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span>
                        <span class="n">referenceType</span><span class="o">(</span><span class="n">ObjectPoolReferenceType</span><span class="o">.</span><span class="na">EAGER_REFERENCED</span><span class="o">);</span>
<span class="n">ObjectOffHeapPoolCreateParameter</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">offHeapPoolParameter</span> <span class="o">=</span> <span class="n">offHeapPoolParameterBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="n">EagerReferencedObjectOffHeapPool</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">eagerReferencedObjectPool</span> <span class="o">=</span> 
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span><span class="n">offHeapPoolParameter</span><span class="o">);</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ELEMENT_COUNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">SampleClass</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">eagerReferencedObjectPool</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">...</span>
<span class="o">}</span>

</pre></div>

<h2>
<a name="43-lazy-referenced-object-offheap-pool" class="anchor" href="#43-lazy-referenced-object-offheap-pool"><span class="octicon octicon-link"></span></a>4.3. Lazy Referenced Object OffHeap Pool</h2>

<div class="highlight highlight-java"><pre>
<span class="n">OffHeapService</span> <span class="n">offHeapService</span> <span class="o">=</span> <span class="n">OffHeapServiceFactory</span><span class="o">.</span><span class="na">getOffHeapService</span><span class="o">();</span>

<span class="n">ObjectOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">offHeapPoolParameterBuilder</span> <span class="o">=</span> 
                <span class="k">new</span> <span class="n">ObjectOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;().</span>
                        <span class="n">type</span><span class="o">(</span><span class="n">SampleClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span>
                        <span class="n">objectCount</span><span class="o">(</span><span class="n">ELEMENT_COUNT</span><span class="o">).</span>
                        <span class="n">makeOffHeapableAsAuto</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span>
                        <span class="n">referenceType</span><span class="o">(</span><span class="n">ObjectPoolReferenceType</span><span class="o">.</span><span class="na">LAZY_REFERENCED</span><span class="o">);</span>
<span class="n">ObjectOffHeapPoolCreateParameter</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">offHeapPoolParameter</span> <span class="o">=</span> <span class="n">offHeapPoolParameterBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="n">LazyReferencedObjectOffHeapPool</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">lazyReferencedObjectPool</span> <span class="o">=</span> 
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span><span class="n">offHeapPoolParameter</span><span class="o">);</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ELEMENT_COUNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">SampleClass</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">lazyReferencedObjectPool</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">...</span>
<span class="o">}</span>

</pre></div>

<h2>
<a name="44-primitive-type-array-offheap-pool" class="anchor" href="#44-primitive-type-array-offheap-pool"><span class="octicon octicon-link"></span></a>4.4. Primitive Type Array OffHeap Pool</h2>

<div class="highlight highlight-java"><pre>
<span class="n">OffHeapService</span> <span class="n">offHeapService</span> <span class="o">=</span> <span class="n">OffHeapServiceFactory</span><span class="o">.</span><span class="na">getOffHeapService</span><span class="o">();</span>

<span class="n">PrimitiveTypeArrayOffHeapPool</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="kt">int</span><span class="o">[]&gt;</span> <span class="n">primitiveTypeArrayPool</span> <span class="o">=</span> 
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span>
                        <span class="k">new</span> <span class="n">ArrayOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;().</span>
                                <span class="n">type</span><span class="o">(</span><span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span>
                                <span class="n">length</span><span class="o">(</span><span class="n">ELEMENT_COUNT</span><span class="o">).</span>
                                <span class="n">usePrimitiveTypes</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span>
                            <span class="n">build</span><span class="o">());</span>

<span class="kt">int</span><span class="o">[]</span> <span class="n">primitiveArray</span> <span class="o">=</span> <span class="n">primitiveTypeArrayPool</span><span class="o">.</span><span class="na">getArray</span><span class="o">();</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">primitiveArray</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">primitiveArray</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
<span class="o">}</span>

</pre></div>

<h2>
<a name="45-complex-type-array-offheap-pool" class="anchor" href="#45-complex-type-array-offheap-pool"><span class="octicon octicon-link"></span></a>4.5. Complex Type Array OffHeap Pool</h2>

<div class="highlight highlight-java"><pre>
<span class="n">OffHeapService</span> <span class="n">offHeapService</span> <span class="o">=</span> <span class="n">OffHeapServiceFactory</span><span class="o">.</span><span class="na">getOffHeapService</span><span class="o">();</span>

<span class="n">ComplexTypeArrayOffHeapPool</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">,</span> <span class="n">SampleClass</span><span class="o">[]&gt;</span> <span class="n">complexTypeArrayPool</span> <span class="o">=</span> 
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span>
                        <span class="k">new</span> <span class="n">ArrayOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;().</span>
                                <span class="n">type</span><span class="o">(</span><span class="n">SampleClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span>
                                <span class="n">length</span><span class="o">(</span><span class="n">ELEMENT_COUNT</span><span class="o">).</span>
                                <span class="n">initializeElements</span><span class="o">(</span><span class="kc">true</span><span class="o">).</span>
                            <span class="n">build</span><span class="o">());</span>

<span class="n">SampleClass</span><span class="o">[]</span> <span class="n">complexArray</span> <span class="o">=</span> <span class="n">complexTypeArrayPool</span><span class="o">.</span><span class="na">getArray</span><span class="o">();</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">complexArray</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">SampleClass</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">complexArray</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
    <span class="o">...</span>
<span class="o">}</span>   

</pre></div>

<h2>
<a name="46-extendable-eager-referenced-object-offheap-pool" class="anchor" href="#46-extendable-eager-referenced-object-offheap-pool"><span class="octicon octicon-link"></span></a>4.6. Extendable Eager Referenced Object OffHeap Pool</h2>

<div class="highlight highlight-java"><pre>
<span class="n">OffHeapService</span> <span class="n">offHeapService</span> <span class="o">=</span> <span class="n">OffHeapServiceFactory</span><span class="o">.</span><span class="na">getOffHeapService</span><span class="o">();</span>

<span class="n">EagerReferencedObjectOffHeapPool</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">sequentialObjectPool</span> <span class="o">=</span> 
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span>
                        <span class="k">new</span> <span class="n">ObjectOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;().</span>
                                <span class="n">type</span><span class="o">(</span><span class="n">SampleClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span>
                                <span class="n">objectCount</span><span class="o">(</span><span class="n">ELEMENT_COUNT</span><span class="o">).</span>
                                <span class="n">referenceType</span><span class="o">(</span><span class="n">ObjectPoolReferenceType</span><span class="o">.</span><span class="na">EAGER_REFERENCED</span><span class="o">).</span>
                            <span class="n">build</span><span class="o">());</span>

<span class="n">ExtendableObjectOffHeapPool</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">extendableObjectPool</span> <span class="o">=</span>
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span>
                        <span class="k">new</span> <span class="n">ExtendableObjectOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;().</span>
                                <span class="n">forkableObjectOffHeapPool</span><span class="o">(</span><span class="n">sequentialObjectPool</span><span class="o">).</span>
                            <span class="n">build</span><span class="o">());</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">TOTAL_ELEMENT_COUNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">SampleClass</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">extendableObjectPool</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">...</span>
<span class="o">}</span>   

</pre></div>

<h2>
<a name="47-extendable-lazy-referenced-object-offheap-pool" class="anchor" href="#47-extendable-lazy-referenced-object-offheap-pool"><span class="octicon octicon-link"></span></a>4.7. Extendable Lazy Referenced Object OffHeap Pool</h2>

<div class="highlight highlight-java"><pre>
<span class="n">OffHeapService</span> <span class="n">offHeapService</span> <span class="o">=</span> <span class="n">OffHeapServiceFactory</span><span class="o">.</span><span class="na">getOffHeapService</span><span class="o">();</span>

<span class="n">LazyReferencedObjectOffHeapPool</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">sequentialObjectPool</span> <span class="o">=</span> 
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span>
                        <span class="k">new</span> <span class="n">ObjectOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;().</span>
                                <span class="n">type</span><span class="o">(</span><span class="n">SampleClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span>
                                <span class="n">objectCount</span><span class="o">(</span><span class="n">ELEMENT_COUNT</span><span class="o">).</span>
                                <span class="n">referenceType</span><span class="o">(</span><span class="n">ObjectPoolReferenceType</span><span class="o">.</span><span class="na">LAZY_REFERENCED</span><span class="o">).</span>
                            <span class="n">build</span><span class="o">());</span>

<span class="n">ExtendableObjectOffHeapPool</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">extendableObjectPool</span> <span class="o">=</span>
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span>
                        <span class="k">new</span> <span class="n">ExtendableObjectOffHeapPoolCreateParameterBuilder</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;().</span>
                                <span class="n">forkableObjectOffHeapPool</span><span class="o">(</span><span class="n">sequentialObjectPool</span><span class="o">).</span>
                            <span class="n">build</span><span class="o">());</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">TOTAL_ELEMENT_COUNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">SampleClass</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">extendableObjectPool</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">...</span>
<span class="o">}</span>   

</pre></div>

<h2>
<a name="48-string-offheap-pool" class="anchor" href="#48-string-offheap-pool"><span class="octicon octicon-link"></span></a>4.8. String OffHeap Pool</h2>

<div class="highlight highlight-java"><pre>
<span class="n">OffHeapService</span> <span class="n">offHeapService</span> <span class="o">=</span> <span class="n">OffHeapServiceFactory</span><span class="o">.</span><span class="na">getOffHeapService</span><span class="o">();</span>

<span class="n">StringOffHeapPool</span> <span class="n">stringPool</span> <span class="o">=</span> 
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span>
                        <span class="k">new</span> <span class="nf">StringOffHeapPoolCreateParameterBuilder</span><span class="o">().</span>
                                <span class="n">estimatedStringCount</span><span class="o">(</span><span class="n">STRING_COUNT</span><span class="o">).</span>
                                <span class="n">estimatedStringLength</span><span class="o">(</span><span class="n">ESTIMATED_STRING_LENGTH</span><span class="o">).</span>
                            <span class="n">build</span><span class="o">());</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">STRING_COUNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stringPool</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"String "</span> <span class="o">+</span> <span class="n">i</span><span class="o">));</span>
<span class="o">}</span>

</pre></div>

<h2>
<a name="49-extendable-string-offheap-pool" class="anchor" href="#49-extendable-string-offheap-pool"><span class="octicon octicon-link"></span></a>4.9. Extendable String OffHeap Pool</h2>

<div class="highlight highlight-java"><pre>
<span class="n">OffHeapService</span> <span class="n">offHeapService</span> <span class="o">=</span> <span class="n">OffHeapServiceFactory</span><span class="o">.</span><span class="na">getOffHeapService</span><span class="o">();</span>

<span class="n">DeeplyForkableStringOffHeapPool</span> <span class="n">stringPool</span> <span class="o">=</span> 
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span>
                        <span class="k">new</span> <span class="nf">StringOffHeapPoolCreateParameterBuilder</span><span class="o">().</span>
                                <span class="n">estimatedStringCount</span><span class="o">(</span><span class="n">STRING_COUNT</span><span class="o">).</span>
                                <span class="n">estimatedStringLength</span><span class="o">(</span><span class="n">ESTIMATED_STRING_LENGTH</span><span class="o">).</span>
                            <span class="n">build</span><span class="o">());</span>

<span class="n">ExtendableStringOffHeapPool</span> <span class="n">extendableStringPool</span> <span class="o">=</span>
                <span class="n">offHeapService</span><span class="o">.</span><span class="na">createOffHeapPool</span><span class="o">(</span>
                        <span class="k">new</span> <span class="nf">ExtendableStringOffHeapPoolCreateParameterBuilder</span><span class="o">().</span>
                                <span class="n">forkableStringOffHeapPool</span><span class="o">(</span><span class="n">stringPool</span><span class="o">).</span>
                            <span class="n">build</span><span class="o">());</span>

<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">TOTAL_STRING_COUNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">stringPool</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"String "</span> <span class="o">+</span> <span class="n">i</span><span class="o">));</span>
<span class="o">}</span>

</pre></div>

<h2>
<a name="410-instrumentation-module" class="anchor" href="#410-instrumentation-module"><span class="octicon octicon-link"></span></a>4.10. Instrumentation Module</h2>

<div class="highlight highlight-java"><pre>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleClass</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="nf">SampleClass</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SampleInstrumentClass.SampleClassToInstrument()"</span><span class="o">);</span> 
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">methodToIntercept</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"SampleInstrumentClass.methodToIntercept()"</span><span class="o">);</span> 
    <span class="o">}</span>

<span class="o">}</span>

</pre></div>

<div class="highlight highlight-java"><pre>
<span class="n">Jillegal</span><span class="o">.</span><span class="na">init</span><span class="o">();</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Before Intrumentation: "</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"====================================================="</span><span class="o">);</span>

<span class="n">SampleClass</span> <span class="n">obj1</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">SampleClass</span><span class="o">();</span>
<span class="n">obj1</span><span class="o">.</span><span class="na">methodToIntercept</span><span class="o">();</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"====================================================="</span><span class="o">);</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"After Intrumentation: "</span><span class="o">);</span>
<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"====================================================="</span><span class="o">);</span>

<span class="n">InstrumentService</span> <span class="n">instrumentService</span> <span class="o">=</span> <span class="n">InstrumentServiceFactory</span><span class="o">.</span><span class="na">getInstrumentService</span><span class="o">();</span>
<span class="n">Instrumenter</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">inst</span> <span class="o">=</span> <span class="n">instrumentService</span><span class="o">.</span><span class="na">getInstrumenter</span><span class="o">(</span><span class="n">SampleClass</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="n">GeneratedClass</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">redefinedClass</span> <span class="o">=</span>
    <span class="n">inst</span><span class="o">.</span>
        <span class="nf">insertBeforeConstructors</span><span class="o">(</span>
            <span class="k">new</span> <span class="n">BeforeConstructorInterceptor</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeConstructor</span><span class="o">(</span><span class="n">SampleClass</span> <span class="n">o</span><span class="o">,</span> <span class="n">Constructor</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;</span> <span class="n">c</span><span class="o">,</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Intercepted by Jillegal before constructor ..."</span><span class="o">);</span>
                <span class="o">}}).</span>

        <span class="n">insertAfterConstructors</span><span class="o">(</span><span class="s">"System.out.println(\"Intercepted by Jillegal after constructor ...\");"</span><span class="o">).</span>

        <span class="n">insertBeforeMethod</span><span class="o">(</span><span class="s">"methodToIntercept"</span><span class="o">,</span> 
            <span class="k">new</span> <span class="n">BeforeMethodInterceptor</span><span class="o">&lt;</span><span class="n">SampleClass</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">beforeMethod</span><span class="o">(</span><span class="n">SampleClass</span> <span class="n">o</span><span class="o">,</span> <span class="n">Method</span> <span class="n">m</span><span class="o">,</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Intercepted by Jillegal before methodToIntercept method ..."</span><span class="o">);</span>
                <span class="o">}}).</span>

        <span class="n">insertAfterMethod</span><span class="o">(</span><span class="s">"methodToIntercept"</span><span class="o">,</span> 
            <span class="s">"System.out.println(\"Intercepted by Jillegal after methodToIntercept method ...\");"</span><span class="o">).</span>

    <span class="n">build</span><span class="o">();</span>

<span class="n">instrumentService</span><span class="o">.</span><span class="na">redefineClass</span><span class="o">(</span><span class="n">redefinedClass</span><span class="o">);</span> 

<span class="n">SampleClass</span> <span class="n">obj2</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">SampleClass</span><span class="o">();</span>
<span class="n">obj2</span><span class="o">.</span><span class="na">methodToIntercept</span><span class="o">();</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"====================================================="</span><span class="o">);</span>

</pre></div>

<h2>
<a name="411-in-memory-java-compiler" class="anchor" href="#411-in-memory-java-compiler"><span class="octicon octicon-link"></span></a>4.11. In Memory Java Compiler</h2>

<div class="highlight highlight-java"><pre>
<span class="n">ClassCompilerService</span> <span class="n">classCompilerService</span> <span class="o">=</span> 
            <span class="n">ClassCompilerServiceFactory</span><span class="o">.</span><span class="na">getClassCompilerService</span><span class="o">();</span>

<span class="n">String</span> <span class="n">code</span> <span class="o">=</span> 
    <span class="s">"package tr.com.serkanozal.jillegal.compiler.demo;"</span><span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"public class SampleJavaClass {"</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\t"</span> <span class="o">+</span> <span class="s">"public String toString() {"</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\t"</span> <span class="o">+</span> <span class="s">"\t"</span> <span class="o">+</span> <span class="s">"return \"I am SampleJavaClass\";"</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\t"</span> <span class="o">+</span>  <span class="s">"}"</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"}"</span><span class="o">;</span>

<span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">compiledClass</span> <span class="o">=</span> <span class="n">classCompilerService</span><span class="o">.</span><span class="na">getClassCompiler</span><span class="o">(</span><span class="n">DefaultCodeType</span><span class="o">.</span><span class="na">JAVA</span><span class="o">).</span><span class="na">compile</span><span class="o">(</span><span class="n">code</span><span class="o">);</span>
<span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">compiledClass</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">obj</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>

</pre></div>

<h2>
<a name="412-in-memory-groovy-compiler" class="anchor" href="#412-in-memory-groovy-compiler"><span class="octicon octicon-link"></span></a>4.12. In Memory Groovy Compiler</h2>

<div class="highlight highlight-java"><pre>
<span class="n">ClassCompilerService</span> <span class="n">classCompilerService</span> <span class="o">=</span> 
            <span class="n">ClassCompilerServiceFactory</span><span class="o">.</span><span class="na">getClassCompilerService</span><span class="o">();</span>

<span class="n">String</span> <span class="n">code</span> <span class="o">=</span> 
    <span class="s">"package tr.com.serkanozal.jillegal.compiler.demo;"</span><span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"public class SampleGroovyClass {"</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\t"</span> <span class="o">+</span> <span class="s">"public String toString() {"</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\t"</span> <span class="o">+</span> <span class="s">"\t"</span> <span class="o">+</span> <span class="s">"def str = \"I am SampleGroovyClass\";"</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\t"</span> <span class="o">+</span> <span class="s">"\t"</span> <span class="o">+</span> <span class="s">"return str;"</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\t"</span> <span class="o">+</span>  <span class="s">"}"</span> <span class="o">+</span> <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"\n"</span> <span class="o">+</span>
    <span class="s">"}"</span><span class="o">;</span>

<span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">compiledClass</span> <span class="o">=</span> <span class="n">classCompilerService</span><span class="o">.</span><span class="na">getClassCompiler</span><span class="o">(</span><span class="n">DefaultCodeType</span><span class="o">.</span><span class="na">GROOVY</span><span class="o">).</span><span class="na">compile</span><span class="o">(</span><span class="n">code</span><span class="o">);</span>
<span class="n">Object</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">compiledClass</span><span class="o">.</span><span class="na">newInstance</span><span class="o">();</span>

<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">obj</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>

</pre></div>

<h1>
<a name="5-roadmap" class="anchor" href="#5-roadmap"><span class="octicon octicon-link"></span></a>5. Roadmap</h1>

<ul>
<li><p>Java 6 / Java 7 support for OffHeap module.</p></li>
<li><p>IBM JVM support for OffHeap module.</p></li>
</ul>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/serkan-ozal">serkan-ozal</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-39596978-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>